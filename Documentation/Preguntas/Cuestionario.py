from jupyterquiz import display_quiz
from random import sample

class Preguntas:
    """
    Posibles preguntas para los examenes de certificacion de Snowflake
    1.- SnowPro Core
    
    """
    
    def __init__(self, num_preguntas:int):
        """
            Metodo que se encarga de inicializar el cuestionario por tema

        Args:
            tema (string): Tema requerido para generar las preguntas. 
        """
        
        if not isinstance(num_preguntas, (int)) or num_preguntas <= 0:
            raise ValueError("El número de preguntas debe de ser mayor a 0")
        self.num_preguntas = num_preguntas
        
        
    def arquitectura(self):
        
        quiz = [ { "question": "What enables Snowflake to support massive concurrency without data contention?", "type": "multiple_choice", "answers": [ {"answer": "Data is replicated across all warehouses for parallel reads", "correct": False}, {"answer": "Warehouses share a distributed file system cache", "correct": False}, {"answer": "Compute is fully isolated while all nodes access the same centralized storage", "correct": True}, {"answer": "Data is copied to each cluster on demand", "correct": False} ] }, { "question": "Which Snowflake layer manages metadata, optimization, and authentication?", "type": "multiple_choice", "answers": [ {"answer": "Storage Layer", "correct": False}, {"answer": "Cloud Services Layer", "correct": True}, {"answer": "Virtual Warehouse Layer", "correct": False}, {"answer": "Compute Layer", "correct": False} ] }, { "question": "A Resource Monitor is set to Suspend Immediately at 90% of credits. What happens when the threshold is hit?", "type": "multiple_choice", "answers": [ {"answer": "Queries continue but run at reduced speed", "correct": False}, {"answer": "Warehouses scale down to minimum size automatically", "correct": False}, {"answer": "Credits reset and queries restart", "correct": False}, {"answer": "Assigned warehouses are suspended and cannot resume until reset or quota increased", "correct": True} ] }, { "question": "What differentiates manual clustering from automatic clustering?", "type": "multiple_choice", "answers": [ {"answer": "Manual clustering uses cloud services; automatic uses warehouses", "correct": False}, {"answer": "Automatic clustering is cheaper", "correct": False}, {"answer": "Automatic clustering requires explicit reclustering commands", "correct": False}, {"answer": "Manual clustering uses warehouse compute; automatic clustering is fully managed by Snowflake", "correct": True} ] }, { "question": "When might manual clustering be preferred?", "type": "multiple_choice", "answers": [ {"answer": "When Snowflake disallows clustering keys", "correct": False}, {"answer": "When no background services are available", "correct": False}, {"answer": "When precise cost control over reclustering is needed", "correct": True}, {"answer": "When table size is under 1 GB", "correct": False} ] }, { "question": "Why do different virtual warehouses NOT share cache?", "type": "multiple_choice", "answers": [ {"answer": "Because Snowflake uses customer-provided SSDs", "correct": False}, {"answer": "To ensure compute isolation and predictable performance", "correct": True}, {"answer": "Because caching is stored in user schemas", "correct": False}, {"answer": "Because storage is ephemeral", "correct": False} ] }, { "question": "Which is the correct fully-qualified object naming sequence?", "type": "multiple_choice", "answers": [ {"answer": "<database>.<schema>.<object>", "correct": True}, {"answer": "<schema>.<table>.<column>", "correct": False}, {"answer": "<object>.<schema>.<database>", "correct": False}, {"answer": "<warehouse>.<database>.<object>", "correct": False} ] }, { "question": "How do schema-level privileges help reduce blast radius?", "type": "multiple_choice", "answers": [ {"answer": "They prevent Time Travel access", "correct": False}, {"answer": "They allow cross-database joins", "correct": False}, {"answer": "They encrypt all objects by default", "correct": False}, {"answer": "They limit privileges to specific namespaces without affecting others", "correct": True} ] }, { "question": "Which table type includes Fail-safe?", "type": "multiple_choice", "answers": [ {"answer": "Temporary", "correct": False}, {"answer": "Transient", "correct": False}, {"answer": "External", "correct": False}, {"answer": "Permanent ", "correct": True} ] }, { "question": "Why are temporary tables cost-efficient for ETL?", "type": "multiple_choice", "answers": [ {"answer": "They auto-compress all data", "correct": False}, {"answer": "They replicate across regions", "correct": False}, {"answer": "They have no Fail-safe and auto-drop at session end", "correct": True}, {"answer": "They cannot be cloned", "correct": False} ] }, { "question": "What happens when cloning a transient table?", "type": "multiple_choice", "answers": [ {"answer": "Clone gains Fail-safe protection", "correct": False}, {"answer": "Fail-safe window is extended", "correct": False}, {"answer": "Clone is automatically permanent", "correct": False}, {"answer": "Clone inherits no Fail-safe and only current Time Travel history", "correct": True} ] }, { "question": "A permanent table with 1-day Time Travel is dropped. How long is the table recoverable?", "type": "multiple_choice", "answers": [ {"answer": "1 day only", "correct": False}, {"answer": "7 days only", "correct": False}, {"answer": "1 day Time Travel + 7 days Fail-safe", "correct": True}, {"answer": "Indefinitely", "correct": False} ] }, { "question": "Why can only Snowflake perform Fail-safe recovery?", "type": "multiple_choice", "answers": [ {"answer": "It uses internal metadata and immutable storage snapshots", "correct": True}, {"answer": "Fail-safe uses customer-managed keys", "correct": False}, {"answer": "It is stored in the Virtual Warehouse layer", "correct": False}, {"answer": "It requires manual SQL commands", "correct": False} ] }, { "question": "Does increasing Time Travel retention affect query performance?", "type": "multiple_choice", "answers": [ {"answer": "Yes, because partitions are recomputed", "correct": False}, {"answer": "Yes, because warehouses must keep data cached", "correct": False}, {"answer": "No, only storage cost increases", "correct": True}, {"answer": "No, because older data is purged immediately", "correct": False} ] }, { "question": "What makes Secure Views secure?", "type": "multiple_choice", "answers": [ {"answer": "They must use Materialized Views as the source", "correct": False}, {"answer": "They encrypt the result set in the table", "correct": False}, {"answer": "They disable Time Travel", "correct": False}, {"answer": "They hide underlying SQL and prevent metadata exposure", "correct": True} ] }, { "question": "Why do Materialized Views increase storage cost?", "type": "multiple_choice", "answers": [ {"answer": "They store multiple copies of the base table", "correct": False}, {"answer": "They store pre-computed micro-partitions on disk", "correct": True}, {"answer": "They replicate data across warehouses", "correct": False}, {"answer": "They require continuous warehouse execution", "correct": False} ] }, { "question": "Which view type is best for fast dashboard queries over stable datasets?", "type": "multiple_choice", "answers": [ {"answer": "Secure View", "correct": False}, {"answer": "Non-Materialized View", "correct": False}, {"answer": "Materialized View", "correct": True}, {"answer": "Temporary View", "correct": False} ] }, { "question": "Which of the following is not allowed in a Materialized View?", "type": "multiple_choice", "answers": [ {"answer": "Aggregations", "correct": False}, {"answer": "Deterministic functions", "correct": False}, {"answer": "Wildcard SELECT (SELECT *)", "correct": True}, {"answer": "Filters", "correct": False} ] }, { "question": "Can you create a Materialized View on top of another Materialized View?", "type": "multiple_choice", "answers": [ {"answer": "No, chaining Materialized Views is not allowed", "correct": True}, {"answer": "Yes, but only in Enterprise edition", "correct": False}, {"answer": "Yes, but only if clustering keys match", "correct": False}, {"answer": "No, but you can chain Secure Views", "correct": False} ] }, { "question": "What is a trade‑off when using Secure Views?", "type": "multiple_choice", "answers": [ {"answer": "They cannot reference permanent tables", "correct": False}, {"answer": "They cost credits to maintain", "correct": False}, {"answer": "They lose Time Travel capability", "correct": False}, {"answer": "Certain performance optimizations (like predicate pushdown) may be restricted", "correct": True} ] } ]
        
        if self.num_preguntas > len(quiz):
            raise ValueError("El número de preguntas solicitado es mayor que las disponibles en el cuestionario.")
        
        return sample(quiz, self.num_preguntas)